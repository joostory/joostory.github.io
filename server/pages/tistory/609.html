<!DOCTYPE html><html lang="ko"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="shortcut icon" href="/favicon.ico"/><meta name="description" content="JooStory.net"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><link rel="canonical" href="https://blog.joostory.net/609"/><title>typescript로 node 서버 만들기</title><meta property="og:type" content="article"/><meta property="og:title" content="typescript로 node 서버 만들기"/><meta property="og:description" content="회사서 계속 java만 쓰다보니 간단한 툴은 node서버를 사용하고 싶어졌다. 그래서 개발에 필요한 도구들을 node로 만들고 있는데 문득 typescript를 쓰고 싶어졌다. 이유는 vscode가 내가 만든 모듈의 자동완성을 잘 안해주고 못해줘서다.
typescript를 type지정기능이 추가된 javascript라고 생각했는데 하다보니 컴파일이 안되는 경우도 많고 외부모듈사용할때도 @types를 추가로 설치해야하고 모르는 부분이 많았다. 소스코드는 "/><meta property="og:image" content="https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="typescript로 node 서버 만들기"/><meta name="twitter:description" content="회사서 계속 java만 쓰다보니 간단한 툴은 node서버를 사용하고 싶어졌다. 그래서 개발에 필요한 도구들을 node로 만들고 있는데 문득 typescript를 쓰고 싶어졌다. 이유는 vscode가 내가 만든 모듈의 자동완성을 잘 안해주고 못해줘서다.
typescript를 type지정기능이 추가된 javascript라고 생각했는데 하다보니 컴파일이 안되는 경우도 많고 외부모듈사용할때도 @types를 추가로 설치해야하고 모르는 부분이 많았다. 소스코드는 "/><meta property="twitter:image" content="https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/11ae7950df9656c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/11ae7950df9656c6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-f4ae3437c92c1efc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f76bbe1730ea85a1.js" defer=""></script><script src="/_next/static/chunks/494-fa03e5491fc3b3a9.js" defer=""></script><script src="/_next/static/chunks/pages/tistory/%5Bid%5D-571a42114028488a.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_buildManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_ssgManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><main><div class=""><div class="pt-40 pb-36 px-20 border-b-[1px] relative"><h1 class="font-bold tracking-tighter leading-tight md:leading-none mb-4 text-center text-3xl">typescript로 node 서버 만들기</h1><div class="flex justify-center"><em class="text-sm"><time dateTime="2021. 4. 1. 16:40">2021. 4. 1. 16:40</time></em></div></div><div class="w-[650px] pt-10 pb-20 mx-auto"><article class="prose"><p>회사서 계속 java만 쓰다보니 간단한 툴은 node서버를 사용하고 싶어졌다. 그래서 개발에 필요한 도구들을 node로 만들고 있는데 문득 typescript를 쓰고 싶어졌다. 이유는 vscode가 내가 만든 모듈의 자동완성을 잘 안해주고 못해줘서다.</p>
<p>typescript를 type지정기능이 추가된 javascript라고 생각했는데 하다보니 컴파일이 안되는 경우도 많고 외부모듈사용할때도 @types를 추가로 설치해야하고 모르는 부분이 많았다. 소스코드는 어찌어찌 고쳐나가면 되는데 결국은 node 서버로 실행해야해서 개발환경, production환경설정도 해줘야했다. 이런저런 삽질을 거쳐서 완료를 하고 나니 기록으로 남겨야겠다는 생각이 들었다.</p>
<h3>개발환경</h3>
<p>아무것도 모를적에는 <a href="https://deno.land/">deno</a>를 쓰면 되는 줄 알았다. 그런데 deno는 node와 전혀 다른 별개의 환경이었다. 모듈, import 모두 달랐다. 그럼 tsc로 빌드한 후에 node로 실행하는가 했는데 ts-node라는 것을 또 발견했다. 그런데 아무래도 production에서는 빌드된 결과물을 실행하는게 나을 것 같아 ts-node는 개발환경에서만 사용하기로 했다.</p>
<pre><code>"scripts": {
    "start": "nodemon --exec ts-node src/app.ts",
}</code></pre>
<h3>모듈 base 설정</h3>
<p>tsconfig에서 baseUrl을 설정하면 import할때 <code>"../service/project"</code> 같은 경로를 <code>"service/project"</code> 로 사용할 수 있다. webpack없이 이런게 되다니 너무 좋았다. 그런데... ts-node와 tsc의 결과물은 이걸 tsconfig의 경로로 알아서 찾아주지 않았다. 오류가 발생했다. tsc가 빌드할때만 찾아주나보다. 그래서 tsconfig-paths라는 모듈을 추가로 사용해야했다.</p>
<p>ts-node에서는 <code>-r tsconfig-paths/register</code> 로 모듈을 로드해주면 해결되었다.&nbsp;</p>
<pre><code>"scripts": {
	"start": "nodemon --exec ts-node -r tsconfig-paths/register src/app.ts",
}</code></pre>
<p>문제는 tsc 빌드 후 node에서 실행할때다. node는 tsconfig을 알아서 읽어주지 않았다. node에서는 별도로 tsconfig-paths를 로드해서 register를 실행해줘야 한다. 아래와 같이 모듈을 만들어서 로드하도록 했다.</p>
<pre><code class="javascript">// tsconfig-paths-bootstrap.js
const tsConfigPaths = require("tsconfig-paths");

const cleanup = tsConfigPaths.register({
  baseUrl: "./dist",
  paths: []
});

//package.json
"scripts": {
  "start": "nodemon --exec ts-node -r tsconfig-paths/register src/app.ts",
  "build": "tsc",
  "start:dist": "node -r ./tsconfig-paths-bootstrap.js dist/app.js"
}</code></pre>
<h3>마치며</h3>
<p>이렇게 typescript 서버 설정을 완료하고 typescript 개발도 완료를 했다. 일단 빌드가 되도록 설정만 잘 해두면 개발은 어찌어찌 되는거 같다. 아직은 얼떨떨하고 잘 모르겠지만 계속해서 하다보면 더 나아지겠지. 한동안 typescript를 계속 파봐야겠다.</p>            </article></div></div></main></div><footer class="bg-slate-100 border-t border-accent-2 mt-6"><div class="py-4 flex flex-col items-center justify-center text-xs text-slate-500"><a href="https://twitter.com/@JooStory">@JooStory</a></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"609","date":"2021. 4. 1. 16:40","title":"typescript로 node 서버 만들기","content":"\u003cp\u003e회사서 계속 java만 쓰다보니 간단한 툴은 node서버를 사용하고 싶어졌다. 그래서 개발에 필요한 도구들을 node로 만들고 있는데 문득 typescript를 쓰고 싶어졌다. 이유는 vscode가 내가 만든 모듈의 자동완성을 잘 안해주고 못해줘서다.\u003c/p\u003e\n\u003cp\u003etypescript를 type지정기능이 추가된 javascript라고 생각했는데 하다보니 컴파일이 안되는 경우도 많고 외부모듈사용할때도 @types를 추가로 설치해야하고 모르는 부분이 많았다. 소스코드는 어찌어찌 고쳐나가면 되는데 결국은 node 서버로 실행해야해서 개발환경, production환경설정도 해줘야했다. 이런저런 삽질을 거쳐서 완료를 하고 나니 기록으로 남겨야겠다는 생각이 들었다.\u003c/p\u003e\n\u003ch3\u003e개발환경\u003c/h3\u003e\n\u003cp\u003e아무것도 모를적에는 \u003ca href=\"https://deno.land/\"\u003edeno\u003c/a\u003e를 쓰면 되는 줄 알았다. 그런데 deno는 node와 전혀 다른 별개의 환경이었다. 모듈, import 모두 달랐다. 그럼 tsc로 빌드한 후에 node로 실행하는가 했는데 ts-node라는 것을 또 발견했다. 그런데 아무래도 production에서는 빌드된 결과물을 실행하는게 나을 것 같아 ts-node는 개발환경에서만 사용하기로 했다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\"scripts\": {\n    \"start\": \"nodemon --exec ts-node src/app.ts\",\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e모듈 base 설정\u003c/h3\u003e\n\u003cp\u003etsconfig에서 baseUrl을 설정하면 import할때 \u003ccode\u003e\"../service/project\"\u003c/code\u003e 같은 경로를 \u003ccode\u003e\"service/project\"\u003c/code\u003e 로 사용할 수 있다. webpack없이 이런게 되다니 너무 좋았다. 그런데... ts-node와 tsc의 결과물은 이걸 tsconfig의 경로로 알아서 찾아주지 않았다. 오류가 발생했다. tsc가 빌드할때만 찾아주나보다. 그래서 tsconfig-paths라는 모듈을 추가로 사용해야했다.\u003c/p\u003e\n\u003cp\u003ets-node에서는 \u003ccode\u003e-r tsconfig-paths/register\u003c/code\u003e 로 모듈을 로드해주면 해결되었다.\u0026nbsp;\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\"scripts\": {\n\t\"start\": \"nodemon --exec ts-node -r tsconfig-paths/register src/app.ts\",\n}\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e문제는 tsc 빌드 후 node에서 실행할때다. node는 tsconfig을 알아서 읽어주지 않았다. node에서는 별도로 tsconfig-paths를 로드해서 register를 실행해줘야 한다. 아래와 같이 모듈을 만들어서 로드하도록 했다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"javascript\"\u003e// tsconfig-paths-bootstrap.js\nconst tsConfigPaths = require(\"tsconfig-paths\");\n\nconst cleanup = tsConfigPaths.register({\n  baseUrl: \"./dist\",\n  paths: []\n});\n\n//package.json\n\"scripts\": {\n  \"start\": \"nodemon --exec ts-node -r tsconfig-paths/register src/app.ts\",\n  \"build\": \"tsc\",\n  \"start:dist\": \"node -r ./tsconfig-paths-bootstrap.js dist/app.js\"\n}\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003e마치며\u003c/h3\u003e\n\u003cp\u003e이렇게 typescript 서버 설정을 완료하고 typescript 개발도 완료를 했다. 일단 빌드가 되도록 설정만 잘 해두면 개발은 어찌어찌 되는거 같다. 아직은 얼떨떨하고 잘 모르겠지만 계속해서 하다보면 더 나아지겠지. 한동안 typescript를 계속 파봐야겠다.\u003c/p\u003e            ","summary":"회사서 계속 java만 쓰다보니 간단한 툴은 node서버를 사용하고 싶어졌다. 그래서 개발에 필요한 도구들을 node로 만들고 있는데 문득 typescript를 쓰고 싶어졌다. 이유는 vscode가 내가 만든 모듈의 자동완성을 잘 안해주고 못해줘서다.\ntypescript를 type지정기능이 추가된 javascript라고 생각했는데 하다보니 컴파일이 안되는 경우도 많고 외부모듈사용할때도 @types를 추가로 설치해야하고 모르는 부분이 많았다. 소스코드는 ","image":"https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"}},"__N_SSG":true},"page":"/tistory/[id]","query":{"id":"609"},"buildId":"k2SjylS4DhAPzPoZgQ49x","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>