{"pageProps":{"post":{"id":"386","date":"2015. 10. 5. 12:30","title":"jQuery CDN 속도문제","content":"<p>언젠가부터 블로그 접속 속도가 무척이나 느려졌다. 굉장히 자주 화면에 아무것도 안나오는 상태로 멈춰있었다. 뭔가 서버 리스스 하나가 response를 주고 있지 않는 것 같았다. 내 블로그에 문제가 생긴건가 싶어서 정말 짜증이 났다. 이걸 해결하려면 어디서부터 시작을 해야하나 티스토리에 문의를 해야하나 짜증은 났지만 참고 찾아보기 시작했다.</p>\n\n<h2>원인</h2><p style=\"text-align: center; clear: none; float: none;\"><span class=\"imageblock\" style=\"display:inline-block;width:683px;;height:auto;max-width:100%\"><span data-url=\"https://t1.daumcdn.net/cfile/tistory/266F83445611EE7719?download\" data-lightbox=\"lightbox\"><img srcset=\"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=http%3A%2F%2Fcfile8.uf.tistory.com%2Fimage%2F266F83445611EE77194730\" src=\"https://t1.daumcdn.net/cfile/tistory/266F83445611EE7719\" style=\"cursor: pointer;max-width:100%;height:auto\" width=\"683\" height=\"46\" filename=\"스크린샷 2015-10-05 오전 12.31.27.png\" filemime=\"image/png\" ></span></span></p>\n<p>처음엔 티스토리 서버에 문제가 생긴 줄 알았는데 가만보니 jquery가 문제였다. 로딩 속도를 빨리하고 싶어서 쓴 cdn인데 여기서 무한정 대기가 걸려있던 거다. 사용하고 있던 cdn은 jquery에서 공식적으로 제공하는 code.jquery.com 서버다.</p>\n<p>찾아보니 <a href=\"http://blog.outsider.ne.kr/493\">jQuery CDN 속도 비교</a>를 한 곳도 있다. 무려 2010년에 작성된 글인데 지금까지 이 문제가 있는 것 같다. 지금도 이 문제가 유효할까 싶어 확인을 해보기로 했다.</p>\n\n<h2>확인</h2>\n\n<p style=\"text-align: center; clear: none; float: none;\"><span class=\"imageblock\" style=\"display:inline-block;width:683px;;height:auto;max-width:100%\"><span data-url=\"https://t1.daumcdn.net/cfile/tistory/257257445611EE7715?download\" data-lightbox=\"lightbox\"><img srcset=\"https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=http%3A%2F%2Fcfile10.uf.tistory.com%2Fimage%2F257257445611EE7715E275\" src=\"https://t1.daumcdn.net/cfile/tistory/257257445611EE7715\" style=\"cursor: pointer;max-width:100%;height:auto\" width=\"683\" height=\"180\" filename=\"스크린샷 2015-10-05 오전 11.01.30.png\" filemime=\"image/png\" ></span></span></p>\n<p>간단히 리소스 다운로드를 하고 시간을 출력하는 스크립트를 만들어서 확인한 결과다. 놀랍게도 code.jquery.com은 로딩 실패가 2번에 평균 1초가 넘는다. 물론 네트웍 상황에 따라 다르겠지만 code.jquery.com은 적어도 나는 사용해선 안되는 cdn이다.</p>\n\n<pre class=\"prettyprint\"><code>#!/usr/bin/env php\n&lt;?\n\nclass Resource {\n\tpublic $provider;\n\tpublic $url;\n\n\tpublic function __construct($provider, $url) {\n\t\t$this-&gt;provider = $provider;\n\t\t$this-&gt;url = $url;\n\t}\n\n\tpublic function check() {\n\t\t$beforeTime = round(microtime(true) * 1000);\n\t\tif ($fp = fopen($this-&gt;url, &#39;r&#39;)) {\n\t\t\twhile (fread($fp, 1024)) {\n\t\t\t\techo(&quot;.&quot;);\n\t\t\t}\n\t\t\t$timeDiff = round(microtime(true) * 1000) - $beforeTime;\n\t\t\techo(&quot; {$timeDiff}ms\\n&quot;);\n\t\t} else {\n\t\t\techo(&quot;Read failed\\n&quot;);\n\t\t}\n\t}\n\n\tpublic function toString() {\n\t\treturn $this-&gt;provider . &quot; : &quot; . $this-&gt;url;\n\t}\n}\n\n$jqueryResources = array(\n\tnew Resource(&quot;Google&quot;, &quot;https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js&quot;),\n\tnew Resource(&quot;MS&quot;, &quot;https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.1.4.min.js&quot;),\n\tnew Resource(&quot;CDNJS&quot;, &quot;https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js&quot;),\n\tnew Resource(&quot;JSDelivr&quot;, &quot;https://cdn.jsdelivr.net/jquery/2.1.4/jquery.min.js&quot;),\n\tnew Resource(&quot;jquery&quot;, &quot;https://code.jquery.com/jquery-2.1.4.min.js&quot;)\n);\n\nforeach($jqueryResources as $resource) {\n\techo ($resource-&gt;toString() . &quot;\\n&quot;);\n\t$resource-&gt;check();\n}</code></pre>            ","summary":"언젠가부터 블로그 접속 속도가 무척이나 느려졌다. 굉장히 자주 화면에 아무것도 안나오는 상태로 멈춰있었다. 뭔가 서버 리스스 하나가 response를 주고 있지 않는 것 같았다. 내 블로그에 문제가 생긴건가 싶어서 정말 짜증이 났다. 이걸 해결하려면 어디서부터 시작을 해야하나 티스토리에 문의를 해야하나 짜증은 났지만 참고 찾아보기 시작했다.\n\n원인\n처음엔 티스토리 서버에 문제가 생긴 줄 알았는데 가만보니 jquery가 문제였다. 로딩 속도를 빨리하고 싶","image":"https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F257257445611EE7715"}},"__N_SSG":true}