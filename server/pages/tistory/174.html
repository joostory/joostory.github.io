<!DOCTYPE html><html lang="ko"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="shortcut icon" href="/favicon.ico"/><meta name="description" content="JooStory.net"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><link rel="canonical" href="https://blog.joostory.net/174"/><title>GIF+PHP 해킹기법을 피하는 방법</title><meta property="og:type" content="article"/><meta property="og:title" content="GIF+PHP 해킹기법을 피하는 방법"/><meta property="og:description" content="헐랭이와 IT보안 블로그는 RSS에 등록해두고 틈틈이 보고 있는데 오늘 눈이 번뜩 떠질만한 이야기가 올라왔습니다.

GIF+PHP 해킹기법에 대한 소개인데 http://durl.kr/eju 에 자세한 내용이 있습니다.
뭐 간단한 예이지만 hack.gif.php 같이 이미지 업로드를 했다고 할때
이 파일이름 그대로를 저장하고 나중에 이미지를 불러올때


&amp;lt;img src=&quot;hack.gif.php&quot; title=&quot;이건 해킹에 취약해!&quot; /&amp;gt;

이런 "/><meta property="og:image" content="https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="GIF+PHP 해킹기법을 피하는 방법"/><meta name="twitter:description" content="헐랭이와 IT보안 블로그는 RSS에 등록해두고 틈틈이 보고 있는데 오늘 눈이 번뜩 떠질만한 이야기가 올라왔습니다.

GIF+PHP 해킹기법에 대한 소개인데 http://durl.kr/eju 에 자세한 내용이 있습니다.
뭐 간단한 예이지만 hack.gif.php 같이 이미지 업로드를 했다고 할때
이 파일이름 그대로를 저장하고 나중에 이미지를 불러올때


&amp;lt;img src=&quot;hack.gif.php&quot; title=&quot;이건 해킹에 취약해!&quot; /&amp;gt;

이런 "/><meta property="twitter:image" content="https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/11ae7950df9656c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/11ae7950df9656c6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-f4ae3437c92c1efc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f76bbe1730ea85a1.js" defer=""></script><script src="/_next/static/chunks/494-fa03e5491fc3b3a9.js" defer=""></script><script src="/_next/static/chunks/pages/tistory/%5Bid%5D-571a42114028488a.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_buildManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_ssgManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><main><div class=""><div class="pt-40 pb-36 px-20 border-b-[1px] relative"><h1 class="font-bold tracking-tighter leading-tight md:leading-none mb-4 text-center text-3xl">GIF+PHP 해킹기법을 피하는 방법</h1><div class="flex justify-center"><em class="text-sm"><time dateTime="2009. 3. 18. 20:24">2009. 3. 18. 20:24</time></em></div></div><div class="w-[650px] pt-10 pb-20 mx-auto"><article class="prose"><a title="[http://swbae.egloos.com]로 이동합니다." target="_blank" href="http://swbae.egloos.com">헐랭이와 IT보안</a> 블로그는 RSS에 등록해두고 틈틈이 보고 있는데 오늘 눈이 번뜩 떠질만한 이야기가 올라왔습니다.<br>
<br>
GIF+PHP 해킹기법에 대한 소개인데 <a title="[http://durl.kr/eju]로 이동합니다." target="_blank" href="http://durl.kr/eju">http://durl.kr/eju</a> 에 자세한 내용이 있습니다.<br>
뭐 간단한 예이지만 hack.gif.php 같이 이미지 업로드를 했다고 할때<br>
이 파일이름 그대로를 저장하고 나중에 이미지를 불러올때<br>
<br>
<div style="border: 1px dashed rgb(193, 193, 193); padding: 10px;" class="txc-textbox">
&lt;img src="hack.gif.php" title="이건 해킹에 취약해!" /&gt;</div>
<br>
이런 식으로 사용하게 되면 해커가 삽입한 php 코드가 실행된다는 것입니다.<br>
물론 맨 나중 확장자를 가져오도록 하면 되긴 하지만 그렇다고 문제가 완전히 해결되는 것은 아닙니다.<br>
<br>
<br>
따라서 다음과 같은 방법을 사용하거나..<br>
<br>
<div style="border: 1px dashed rgb(193, 193, 193); padding: 10px;" class="txc-textbox">
$file = 'image.gif.php';<br>
Header('Content-Type: image/gif');<br>
readfile('images/'.basename($file));</div>
<br>
<br>
헐랭이님이 두번이나 강조하는 바와 같이 이렇게 해야겠습니다.<br>
<br>
<div style="border: 1px dashed rgb(193, 193, 193); padding: 10px;" class="txc-textbox">
이런 공격 기법을 막기 위해서는 파일 업로드 검사 시&nbsp;지금처럼 확장자에 기반한 검사를 수행하는 것에서 한발짝 나아가서<br>
1. &nbsp;파일 헤더 부분과 바디 부분을 읽어 정상적인 이미지 파일인지 검사<br>
하는 것이 필요하다.</div>
<br>
<br>
<br>            </article></div></div></main></div><footer class="bg-slate-100 border-t border-accent-2 mt-6"><div class="py-4 flex flex-col items-center justify-center text-xs text-slate-500"><a href="https://twitter.com/@JooStory">@JooStory</a></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"174","date":"2009. 3. 18. 20:24","title":"GIF+PHP 해킹기법을 피하는 방법","content":"\u003ca title=\"[http://swbae.egloos.com]로 이동합니다.\" target=\"_blank\" href=\"http://swbae.egloos.com\"\u003e헐랭이와 IT보안\u003c/a\u003e 블로그는 RSS에 등록해두고 틈틈이 보고 있는데 오늘 눈이 번뜩 떠질만한 이야기가 올라왔습니다.\u003cbr\u003e\n\u003cbr\u003e\nGIF+PHP 해킹기법에 대한 소개인데 \u003ca title=\"[http://durl.kr/eju]로 이동합니다.\" target=\"_blank\" href=\"http://durl.kr/eju\"\u003ehttp://durl.kr/eju\u003c/a\u003e 에 자세한 내용이 있습니다.\u003cbr\u003e\n뭐 간단한 예이지만 hack.gif.php 같이 이미지 업로드를 했다고 할때\u003cbr\u003e\n이 파일이름 그대로를 저장하고 나중에 이미지를 불러올때\u003cbr\u003e\n\u003cbr\u003e\n\u003cdiv style=\"border: 1px dashed rgb(193, 193, 193); padding: 10px;\" class=\"txc-textbox\"\u003e\n\u0026lt;img src=\"hack.gif.php\" title=\"이건 해킹에 취약해!\" /\u0026gt;\u003c/div\u003e\n\u003cbr\u003e\n이런 식으로 사용하게 되면 해커가 삽입한 php 코드가 실행된다는 것입니다.\u003cbr\u003e\n물론 맨 나중 확장자를 가져오도록 하면 되긴 하지만 그렇다고 문제가 완전히 해결되는 것은 아닙니다.\u003cbr\u003e\n\u003cbr\u003e\n\u003cbr\u003e\n따라서 다음과 같은 방법을 사용하거나..\u003cbr\u003e\n\u003cbr\u003e\n\u003cdiv style=\"border: 1px dashed rgb(193, 193, 193); padding: 10px;\" class=\"txc-textbox\"\u003e\n$file = 'image.gif.php';\u003cbr\u003e\nHeader('Content-Type: image/gif');\u003cbr\u003e\nreadfile('images/'.basename($file));\u003c/div\u003e\n\u003cbr\u003e\n\u003cbr\u003e\n헐랭이님이 두번이나 강조하는 바와 같이 이렇게 해야겠습니다.\u003cbr\u003e\n\u003cbr\u003e\n\u003cdiv style=\"border: 1px dashed rgb(193, 193, 193); padding: 10px;\" class=\"txc-textbox\"\u003e\n이런 공격 기법을 막기 위해서는 파일 업로드 검사 시\u0026nbsp;지금처럼 확장자에 기반한 검사를 수행하는 것에서 한발짝 나아가서\u003cbr\u003e\n1. \u0026nbsp;파일 헤더 부분과 바디 부분을 읽어 정상적인 이미지 파일인지 검사\u003cbr\u003e\n하는 것이 필요하다.\u003c/div\u003e\n\u003cbr\u003e\n\u003cbr\u003e\n\u003cbr\u003e            ","summary":"헐랭이와 IT보안 블로그는 RSS에 등록해두고 틈틈이 보고 있는데 오늘 눈이 번뜩 떠질만한 이야기가 올라왔습니다.\n\nGIF+PHP 해킹기법에 대한 소개인데 http://durl.kr/eju 에 자세한 내용이 있습니다.\n뭐 간단한 예이지만 hack.gif.php 같이 이미지 업로드를 했다고 할때\n이 파일이름 그대로를 저장하고 나중에 이미지를 불러올때\n\n\n\u0026lt;img src=\"hack.gif.php\" title=\"이건 해킹에 취약해!\" /\u0026gt;\n\n이런 ","image":"https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"}},"__N_SSG":true},"page":"/tistory/[id]","query":{"id":"174"},"buildId":"k2SjylS4DhAPzPoZgQ49x","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>