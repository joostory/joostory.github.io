<!DOCTYPE html><html lang="ko"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="shortcut icon" href="/favicon.ico"/><meta name="description" content="JooStory.net"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><link rel="canonical" href="https://blog.joostory.net/585"/><title>Github Actions를 이용한 npm publish</title><meta property="og:type" content="article"/><meta property="og:title" content="Github Actions를 이용한 npm publish"/><meta property="og:description" content="Tistory Editor의 빌드와 배포를 Github Actions로 변경한 후 다른 것도 해보고 싶었는데 때마침 tinymce plugin을 수정해야할 일이 생겼다. opengraph플러그인인데 Tistory Editor 소스코드에 포함하지 않았고 npm을 통해서 import하고 있다.
할일은 코드를 수정하고 tag를 만들면 npm install, npm publish를 하는 것이다. 또 npm publish를 할 때 인증처리를 해야한다.
npmpu"/><meta property="og:image" content="https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Github Actions를 이용한 npm publish"/><meta name="twitter:description" content="Tistory Editor의 빌드와 배포를 Github Actions로 변경한 후 다른 것도 해보고 싶었는데 때마침 tinymce plugin을 수정해야할 일이 생겼다. opengraph플러그인인데 Tistory Editor 소스코드에 포함하지 않았고 npm을 통해서 import하고 있다.
할일은 코드를 수정하고 tag를 만들면 npm install, npm publish를 하는 것이다. 또 npm publish를 할 때 인증처리를 해야한다.
npmpu"/><meta property="twitter:image" content="https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/11ae7950df9656c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/11ae7950df9656c6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-f4ae3437c92c1efc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f76bbe1730ea85a1.js" defer=""></script><script src="/_next/static/chunks/494-fa03e5491fc3b3a9.js" defer=""></script><script src="/_next/static/chunks/pages/tistory/%5Bid%5D-571a42114028488a.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_buildManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_ssgManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><main><div class=""><div class="pt-40 pb-36 px-20 border-b-[1px] relative"><h1 class="font-bold tracking-tighter leading-tight md:leading-none mb-4 text-center text-3xl">Github Actions를 이용한 npm publish</h1><div class="flex justify-center"><em class="text-sm"><time dateTime="2019. 12. 6. 23:14">2019. 12. 6. 23:14</time></em></div></div><div class="w-[650px] pt-10 pb-20 mx-auto"><article class="prose"><p>Tistory Editor의 빌드와 배포를 Github Actions로 변경한 후 다른 것도 해보고 싶었는데 때마침 tinymce plugin을 수정해야할 일이 생겼다. opengraph플러그인인데 Tistory Editor 소스코드에 포함하지 않았고 npm을 통해서 import하고 있다.</p>
<p>할일은 코드를 수정하고 tag를 만들면 npm install, npm publish를 하는 것이다. 또 npm publish를 할 때 인증처리를 해야한다.</p>
<h2>npmpublish.yml</h2>
<pre><code>name: Release

on:
  push:
    tags:
      - v*

jobs:
  publish-npm:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - uses: actions/setup-node@v1
        with:
          node-version: 12
          registry-url: https://registry.npmjs.org/
      - run: npm install
      - run: npm publish
        env:
          NODE_AUTH_TOKEN: ${{secrets.npm_token}}</code></pre><p>npm publish를 위한 workflow는 electron에 비해 굉장히 간단하다. 먼저 하나의 os에서만 해도 된다. 아무래도 개발/빌드 머신으로는 ubuntu가 좋은 것 같다. checkout은 당연히 하는거고 setup-node를 할때 registry-url을 지정해준다. 원래는 당연히 npmjs 뿐이었지만 지금은 yarn도 있고 github repository도 있으니 명시적으로 지정하는 것이 좋다.</p>
<p>가장 중요한 publish에서의 인증은 생각보다 간단하다. <code>NODE_AUTH_TOKEN</code>란 이름으로 npmjs에서 생성한 토큰을 넣어주면 된다. 이렇게만 하면 끝이다.</p>
<hr>
<p>이렇게 하고 보니 flutter도 쉽게 할 수 있을 것 같다. flutter 설치와 apk 생성, release에 업로드까지만 하면 되니까... 뭐 play store에 업로드해도 되고. 다음에 수정할때 해봐야겠다.</p>
            </article></div></div></main></div><footer class="bg-slate-100 border-t border-accent-2 mt-6"><div class="py-4 flex flex-col items-center justify-center text-xs text-slate-500"><a href="https://twitter.com/@JooStory">@JooStory</a></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"585","date":"2019. 12. 6. 23:14","title":"Github Actions를 이용한 npm publish","content":"\u003cp\u003eTistory Editor의 빌드와 배포를 Github Actions로 변경한 후 다른 것도 해보고 싶었는데 때마침 tinymce plugin을 수정해야할 일이 생겼다. opengraph플러그인인데 Tistory Editor 소스코드에 포함하지 않았고 npm을 통해서 import하고 있다.\u003c/p\u003e\n\u003cp\u003e할일은 코드를 수정하고 tag를 만들면 npm install, npm publish를 하는 것이다. 또 npm publish를 할 때 인증처리를 해야한다.\u003c/p\u003e\n\u003ch2\u003enpmpublish.yml\u003c/h2\u003e\n\u003cpre\u003e\u003ccode\u003ename: Release\n\non:\n  push:\n    tags:\n      - v*\n\njobs:\n  publish-npm:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v1\n      - uses: actions/setup-node@v1\n        with:\n          node-version: 12\n          registry-url: https://registry.npmjs.org/\n      - run: npm install\n      - run: npm publish\n        env:\n          NODE_AUTH_TOKEN: ${{secrets.npm_token}}\u003c/code\u003e\u003c/pre\u003e\u003cp\u003enpm publish를 위한 workflow는 electron에 비해 굉장히 간단하다. 먼저 하나의 os에서만 해도 된다. 아무래도 개발/빌드 머신으로는 ubuntu가 좋은 것 같다. checkout은 당연히 하는거고 setup-node를 할때 registry-url을 지정해준다. 원래는 당연히 npmjs 뿐이었지만 지금은 yarn도 있고 github repository도 있으니 명시적으로 지정하는 것이 좋다.\u003c/p\u003e\n\u003cp\u003e가장 중요한 publish에서의 인증은 생각보다 간단하다. \u003ccode\u003eNODE_AUTH_TOKEN\u003c/code\u003e란 이름으로 npmjs에서 생성한 토큰을 넣어주면 된다. 이렇게만 하면 끝이다.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e이렇게 하고 보니 flutter도 쉽게 할 수 있을 것 같다. flutter 설치와 apk 생성, release에 업로드까지만 하면 되니까... 뭐 play store에 업로드해도 되고. 다음에 수정할때 해봐야겠다.\u003c/p\u003e\n            ","summary":"Tistory Editor의 빌드와 배포를 Github Actions로 변경한 후 다른 것도 해보고 싶었는데 때마침 tinymce plugin을 수정해야할 일이 생겼다. opengraph플러그인인데 Tistory Editor 소스코드에 포함하지 않았고 npm을 통해서 import하고 있다.\n할일은 코드를 수정하고 tag를 만들면 npm install, npm publish를 하는 것이다. 또 npm publish를 할 때 인증처리를 해야한다.\nnpmpu","image":"https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"}},"__N_SSG":true},"page":"/tistory/[id]","query":{"id":"585"},"buildId":"k2SjylS4DhAPzPoZgQ49x","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>