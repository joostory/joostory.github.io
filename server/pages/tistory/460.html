<!DOCTYPE html><html lang="ko"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="shortcut icon" href="/favicon.ico"/><meta name="description" content="JooStory.net"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><link rel="canonical" href="https://blog.joostory.net/460"/><title>Clipboard 이미지의 업로드</title><meta property="og:type" content="article"/><meta property="og:title" content="Clipboard 이미지의 업로드"/><meta property="og:description" content="난 한번도 그런 생각을 해본 적이 없는데 클립보드의 이미지를 업로드할 수 있게 해달라는 요청을 여러번 받았다. 내 생각에는 이미지 파일로 만들어서 업로드하는 것이 관리도 편하고 더 좋을 것 같은데 클립보드에서 바로 업로드로 이어지는 것이 더 편한가보다. 내가 편히 쓰려고 만든 프로그램이라 내가 안쓰는 기능은 왠만하면 잘 넣지 않지만 이번엔 시간을 내서 해보기로 했다.
Electron의 클립보드
Electron에서는 clipboard의 이미지를 반환해주는"/><meta property="og:image" content="https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&amp;fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F23754B445888E4880B"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Clipboard 이미지의 업로드"/><meta name="twitter:description" content="난 한번도 그런 생각을 해본 적이 없는데 클립보드의 이미지를 업로드할 수 있게 해달라는 요청을 여러번 받았다. 내 생각에는 이미지 파일로 만들어서 업로드하는 것이 관리도 편하고 더 좋을 것 같은데 클립보드에서 바로 업로드로 이어지는 것이 더 편한가보다. 내가 편히 쓰려고 만든 프로그램이라 내가 안쓰는 기능은 왠만하면 잘 넣지 않지만 이번엔 시간을 내서 해보기로 했다.
Electron의 클립보드
Electron에서는 clipboard의 이미지를 반환해주는"/><meta property="twitter:image" content="https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2&amp;fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F23754B445888E4880B"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/11ae7950df9656c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/11ae7950df9656c6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-f4ae3437c92c1efc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f76bbe1730ea85a1.js" defer=""></script><script src="/_next/static/chunks/494-fa03e5491fc3b3a9.js" defer=""></script><script src="/_next/static/chunks/pages/tistory/%5Bid%5D-571a42114028488a.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_buildManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_ssgManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><main><div class=""><div class="pt-40 pb-36 px-20 border-b-[1px] relative"><h1 class="font-bold tracking-tighter leading-tight md:leading-none mb-4 text-center text-3xl">Clipboard 이미지의 업로드</h1><div class="flex justify-center"><em class="text-sm"><time dateTime="2017. 1. 26. 03:16">2017. 1. 26. 03:16</time></em></div></div><div class="w-[650px] pt-10 pb-20 mx-auto"><article class="prose"><p>난 한번도 그런 생각을 해본 적이 없는데 클립보드의 이미지를 업로드할 수 있게 해달라는 요청을 여러번 받았다. 내 생각에는 이미지 파일로 만들어서 업로드하는 것이 관리도 편하고 더 좋을 것 같은데 클립보드에서 바로 업로드로 이어지는 것이 더 편한가보다. 내가 편히 쓰려고 만든 프로그램이라 내가 안쓰는 기능은 왠만하면 잘 넣지 않지만 이번엔 시간을 내서 해보기로 했다.</p>
<h2 id="electron-">Electron의 클립보드</h2>
<p>Electron에서는 <a href="http://electron.atom.io/docs/api/clipboard/#clipboardreadimagetype">clipboard의 이미지를 반환해주는 api</a>를 제공하는데 그 이미지라는 것은 <a href="http://electron.atom.io/docs/api/native-image/">nativeImage</a>다. nativeImage를 png나 jpeg, bitmap으로 변환하면 드디어 업로드 가능한 데이터가 만들어진다. 이 데이터는 또 <a href="https://nodejs.org/api/buffer.html#buffer_class_buffer">Buffer</a>로 만들어지는데 업로드하기 위해선 stream으로 변환이 필요하다. stream을 formdata에 넣어주면 정말 업로드가 된다.</p>
<p>요약하자면 <code>clipboard -&gt; nativeImage -&gt; buffer -&gt; stream -&gt; formdata</code> 의 과정을 거쳐야 한다는 것이다. 참 복잡하다. 게다가 formdata에 filename과 content-type을 지정해줘야 tistory api가 받아준다. 수많은 시행착오를 거쳐서 결국 만든 코드는 이렇다. (clipboard 업로드 기능을 만든 기념으로 text 대신 이미지로..)</p>
<p><img src="https://t1.daumcdn.net/cfile/tistory/23754B445888E4880B" alt=""></p>
<h2 id="-">개밥먹기</h2>
<p>말했듯이 클립보드의 이미지를 바로 업로드 하는 걸 생각해본 적도 없고 원하지도 않았다. 그런데 막상 써보니 생각보다 좋다. 특히 뭔가를 설명할 때 아주 유용하다. 방금도 코드를 복사해서 넣었다. 아주 편하게. 스크린샷을 만들때 키보드 키하나를 더 누르기만 하면 되니 파일을 이리저리 옮기는 번거로운 일이 없어졌다. 잘 안 쓸 줄 알았는데 어째 내가 잘 쓰게 될 것 같다. 좋다.</p>
            </article></div></div></main></div><footer class="bg-slate-100 border-t border-accent-2 mt-6"><div class="py-4 flex flex-col items-center justify-center text-xs text-slate-500"><a href="https://twitter.com/@JooStory">@JooStory</a></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"460","date":"2017. 1. 26. 03:16","title":"Clipboard 이미지의 업로드","content":"\u003cp\u003e난 한번도 그런 생각을 해본 적이 없는데 클립보드의 이미지를 업로드할 수 있게 해달라는 요청을 여러번 받았다. 내 생각에는 이미지 파일로 만들어서 업로드하는 것이 관리도 편하고 더 좋을 것 같은데 클립보드에서 바로 업로드로 이어지는 것이 더 편한가보다. 내가 편히 쓰려고 만든 프로그램이라 내가 안쓰는 기능은 왠만하면 잘 넣지 않지만 이번엔 시간을 내서 해보기로 했다.\u003c/p\u003e\n\u003ch2 id=\"electron-\"\u003eElectron의 클립보드\u003c/h2\u003e\n\u003cp\u003eElectron에서는 \u003ca href=\"http://electron.atom.io/docs/api/clipboard/#clipboardreadimagetype\"\u003eclipboard의 이미지를 반환해주는 api\u003c/a\u003e를 제공하는데 그 이미지라는 것은 \u003ca href=\"http://electron.atom.io/docs/api/native-image/\"\u003enativeImage\u003c/a\u003e다. nativeImage를 png나 jpeg, bitmap으로 변환하면 드디어 업로드 가능한 데이터가 만들어진다. 이 데이터는 또 \u003ca href=\"https://nodejs.org/api/buffer.html#buffer_class_buffer\"\u003eBuffer\u003c/a\u003e로 만들어지는데 업로드하기 위해선 stream으로 변환이 필요하다. stream을 formdata에 넣어주면 정말 업로드가 된다.\u003c/p\u003e\n\u003cp\u003e요약하자면 \u003ccode\u003eclipboard -\u0026gt; nativeImage -\u0026gt; buffer -\u0026gt; stream -\u0026gt; formdata\u003c/code\u003e 의 과정을 거쳐야 한다는 것이다. 참 복잡하다. 게다가 formdata에 filename과 content-type을 지정해줘야 tistory api가 받아준다. 수많은 시행착오를 거쳐서 결국 만든 코드는 이렇다. (clipboard 업로드 기능을 만든 기념으로 text 대신 이미지로..)\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://t1.daumcdn.net/cfile/tistory/23754B445888E4880B\" alt=\"\"\u003e\u003c/p\u003e\n\u003ch2 id=\"-\"\u003e개밥먹기\u003c/h2\u003e\n\u003cp\u003e말했듯이 클립보드의 이미지를 바로 업로드 하는 걸 생각해본 적도 없고 원하지도 않았다. 그런데 막상 써보니 생각보다 좋다. 특히 뭔가를 설명할 때 아주 유용하다. 방금도 코드를 복사해서 넣었다. 아주 편하게. 스크린샷을 만들때 키보드 키하나를 더 누르기만 하면 되니 파일을 이리저리 옮기는 번거로운 일이 없어졌다. 잘 안 쓸 줄 알았는데 어째 내가 잘 쓰게 될 것 같다. 좋다.\u003c/p\u003e\n            ","summary":"난 한번도 그런 생각을 해본 적이 없는데 클립보드의 이미지를 업로드할 수 있게 해달라는 요청을 여러번 받았다. 내 생각에는 이미지 파일로 만들어서 업로드하는 것이 관리도 편하고 더 좋을 것 같은데 클립보드에서 바로 업로드로 이어지는 것이 더 편한가보다. 내가 편히 쓰려고 만든 프로그램이라 내가 안쓰는 기능은 왠만하면 잘 넣지 않지만 이번엔 시간을 내서 해보기로 했다.\nElectron의 클립보드\nElectron에서는 clipboard의 이미지를 반환해주는","image":"https://img1.daumcdn.net/thumb/R800x0/?scode=mtistory2\u0026fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F23754B445888E4880B"}},"__N_SSG":true},"page":"/tistory/[id]","query":{"id":"460"},"buildId":"k2SjylS4DhAPzPoZgQ49x","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>