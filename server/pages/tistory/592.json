{"pageProps":{"post":{"id":"592","date":"2020. 3. 4. 23:06","title":"tumblr api 오류","content":"<p>갑자기 tumblr에 새 글을 작성하면 실제로 글은 등록되는데 API 에서 404 오류가 발생했다. 갑작스런 코로나 위기로 v1 릴리즈 이후에 앱에 신경을 못써서 막연히 post api에 문제가 있다고만 생각했다. 시간이 되면 확인해야지 하다가 오늘에 이르렀다.</p>\n<h2>원인</h2>\n<p>에디터에서 글을 등록하는 과정은 이렇다. 먼저 글내용을 등록하는 api를 호출하고 호출결과로 등록된 글의 id를 받아온다. 이 id로 글의 내용을 읽어 리스트에 추가한다. 이렇게 새로운 글이 리스트에 추가된다.</p>\n<p>post api가 문제라고 생각했기때문에 post api에 대한 테스트코드를 작성해서 새글을 작성해봤다. 어라? 201응답이 오고 id도 잘온다. 아뿔싸... 그럼 api 문제가 아니라 에디터 앱 내부의 오류인가? 당황했다. 문제가 없다고 생각했는데... 역시나 문제는 이 id로 글 내용을 읽어오는 과정에서 발생했다. 404 응답이 온다.</p>\n<p>하나의 글을 읽는 api는 오직 글을 작성할 때와 수정할 때만 호출한다. 여기에 문제가 있다? 이전까지는 잘 동작하다가 갑자기 동작안하는 것인데? 뭔가 이상하다. 분명히 api가 준 id를 그대로 사용했는데... 라고 생각하는 순간. 수정할 때 api로 요청한 id와 응답으로 돌아온 id가 다른 것이 눈에 들어온다. 이상하다. api가 알려준 id로 브라우저에서 실제 글로 접근해본다. 404 오류가 발생한다.</p>\n<p>그럼 뭐가 문제인가? 문제는 post, edit api에서 돌려주는 id가 잘못된 것이었다. 그걸론 글 정보를 가져올 수 없었다.</p>\n<h2>해결</h2>\n<p>으아아아아아!!!!! 정말 api 문제가 맞았다. 근데 이걸 어떻게 발견해 -_- 거기다 새로운 글 어떻게 가져와 -_- 다행히 글 리스트 api를 limit 1로 불러오는 방법이 떠올라 해결은 했지만 황당했다. 희안하게도 id의 앞부분은 비슷한데 뒷부분이 조금 다르다.</p>\n<p>추측하기로는 뭔가 뒤에 시간을 활용한 값을 붙이는데 그 시간이 달라져서 그런게 아닌가싶다. 여긴 한국이고 tumblr는 미국서비스니까. 에이 모르겠다. 이런거 추측해서 뭐하나. tumblr에 알려주기나 해야지.</p>\n<hr>\n<p>이렇게 힘겹게 거의 10일만에 이 문제를 수정했다. 아후... 그동안 새글쓸 때 자꾸 오류발생해서 괜히 글도 안쓰게 됐는데 이제는 좀 쓸 수 있겠다.</p>            ","summary":"갑자기 tumblr에 새 글을 작성하면 실제로 글은 등록되는데 API 에서 404 오류가 발생했다. 갑작스런 코로나 위기로 v1 릴리즈 이후에 앱에 신경을 못써서 막연히 post api에 문제가 있다고만 생각했다. 시간이 되면 확인해야지 하다가 오늘에 이르렀다.\n원인\n에디터에서 글을 등록하는 과정은 이렇다. 먼저 글내용을 등록하는 api를 호출하고 호출결과로 등록된 글의 id를 받아온다. 이 id로 글의 내용을 읽어 리스트에 추가한다. 이렇게 새로운 글","image":"https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"}},"__N_SSG":true}