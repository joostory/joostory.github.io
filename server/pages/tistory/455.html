<!DOCTYPE html><html lang="ko"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="shortcut icon" href="/favicon.ico"/><meta name="description" content="JooStory.net"/><meta property="og:image" content="https://og-image.vercel.app/Next.js%20Blog%20Starter%20Example.png?theme=light&amp;md=1&amp;fontSize=100px&amp;images=https%3A%2F%2Fassets.vercel.com%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fnextjs-black-logo.svg"/><link rel="canonical" href="https://blog.joostory.net/455"/><title>delta-to-html</title><meta property="og:type" content="article"/><meta property="og:title" content="delta-to-html"/><meta property="og:description" content="지금은 1월 11일 1시 11분이다. 뭐 그렇다고 ;;
Tistory Editor에 Quilljs를 붙였는데 생각했던 것처럼 쉽지가 않았다. 결국 나는 html이 필요하고 Quilljs의 데이터를 html로 변환해야 한다. Quilljs의 개발자는 1.0 버전에서 getHtml을 없애버렸다. 이유는 더이상 에디터 dom에 class들이 붙지 않아 innerHTML 로 깨끗한 html을 얻을 수 있기 때문이라고 한다. 그런데 code-block 같은 경우"/><meta property="og:image" content="https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="delta-to-html"/><meta name="twitter:description" content="지금은 1월 11일 1시 11분이다. 뭐 그렇다고 ;;
Tistory Editor에 Quilljs를 붙였는데 생각했던 것처럼 쉽지가 않았다. 결국 나는 html이 필요하고 Quilljs의 데이터를 html로 변환해야 한다. Quilljs의 개발자는 1.0 버전에서 getHtml을 없애버렸다. 이유는 더이상 에디터 dom에 class들이 붙지 않아 innerHTML 로 깨끗한 html을 얻을 수 있기 때문이라고 한다. 그런데 code-block 같은 경우"/><meta property="twitter:image" content="https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"/><meta name="next-head-count" content="15"/><link rel="preload" href="/_next/static/css/11ae7950df9656c6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/11ae7950df9656c6.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-fc97f3f1282ce3ed.js" defer=""></script><script src="/_next/static/chunks/main-f4ae3437c92c1efc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f76bbe1730ea85a1.js" defer=""></script><script src="/_next/static/chunks/494-fa03e5491fc3b3a9.js" defer=""></script><script src="/_next/static/chunks/pages/tistory/%5Bid%5D-571a42114028488a.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_buildManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_ssgManifest.js" defer=""></script><script src="/_next/static/k2SjylS4DhAPzPoZgQ49x/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><main><div class=""><div class="pt-40 pb-36 px-20 border-b-[1px] relative"><h1 class="font-bold tracking-tighter leading-tight md:leading-none mb-4 text-center text-3xl">delta-to-html</h1><div class="flex justify-center"><em class="text-sm"><time dateTime="2017. 1. 11. 01:37">2017. 1. 11. 01:37</time></em></div></div><div class="w-[650px] pt-10 pb-20 mx-auto"><article class="prose"><p>지금은 1월 11일 1시 11분이다. 뭐 그렇다고 ;;</p>
<p>Tistory Editor에 Quilljs를 붙였는데 생각했던 것처럼 쉽지가 않았다. 결국 나는 html이 필요하고 Quilljs의 데이터를 html로 변환해야 한다. Quilljs의 개발자는 1.0 버전에서 <a href="https://github.com/quilljs/quill/issues/774">getHtml을 없애버렸다</a>. 이유는 더이상 에디터 dom에 class들이 붙지 않아 innerHTML 로 깨끗한 html을 얻을 수 있기 때문이라고 한다. 그런데 code-block 같은 경우는 내가 원하는 <code>&lt;pre&gt;&lt;code&gt;</code>가 아니라 <code>&lt;pre&gt;</code>로만 만들어진다. 거기다 syntax highlight를 하면 그 부분은 완전히 변형된다. 거의 쓸 수 없는 수준이다.</p>
<p>한동안 찾아다녔다. getContents를 통해서 얻은 Delta를 html로 변환하는 것을 누군가는 만들어뒀겠지 하며 찾았다. 그런데 없다. code-block를 대응한 것을 찾지 못했다. 아마도 대부분의 경우 innerHTML로 충분했던 것 같다. 아무래도 직접 만들어야 할 것 같았다. 그래서 시작했다.</p>
<h2 id="delta-to-html">delta-to-html</h2>
<p>사실 javascript로 모듈을 제작해 본 경험이 없다. 그래서 다른 모듈을 참고해서 시작했다. 테스트, 커버리지 같은 것들을 먼저 세팅했다.</p>
<p>테스트는 <a href="https://mochajs.org/">mocha</a>가 유명한 것 같은데 참고한 모듈이 <a href="https://jasmine.github.io/">jasmine</a>을 사용해서 나도 jasmine을 사용해보기로 했다. ci 서비스는 이전에 <a href="https://circleci.com/">circleci</a>를 써봤으니 이번엔 <a href="https://travis-ci.org/">travis-ci</a>를 사용하기로 했다. coverage는 가능하다는 것을 이번 기회에 알았다. github에 연동된 <a href="https://coveralls.io/">coveralls</a>라는 서비스도 있는 마당에 이런 걸 처음 알다니 ㅠㅠ 앞으로 놀지 않고 공부많이 해야겠다는 생각이 들었다.</p>
<p>이렇게 세팅을 하고보니 TDD가 가능할 것 같다. 결국 BDD로 하긴 했지만 어쨌든 스펙을 먼저 테스트로 만들고 해결을 해나가는 일을 정말 오랜 만에 해본 것 같다. 이것도 자꾸자꾸 해봐야 익숙해져서 또 하게 되는 것 같다.</p>
<h2 id="-">완성</h2>
<p>시행착오도 많았고, 코드가 엄청 더럽고 복잡하게 나오긴 했지만 일단은 모든 테스트를 통과하는 결과물이 나왔다. <a href="https://www.npmjs.com/package/delta-to-html">npm에 publish</a>도 처음 해봤다. 에디터에 붙여보니 잘된다. 이제 다음 단계로 갈 차례다.</p>
            </article></div></div></main></div><footer class="bg-slate-100 border-t border-accent-2 mt-6"><div class="py-4 flex flex-col items-center justify-center text-xs text-slate-500"><a href="https://twitter.com/@JooStory">@JooStory</a></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":"455","date":"2017. 1. 11. 01:37","title":"delta-to-html","content":"\u003cp\u003e지금은 1월 11일 1시 11분이다. 뭐 그렇다고 ;;\u003c/p\u003e\n\u003cp\u003eTistory Editor에 Quilljs를 붙였는데 생각했던 것처럼 쉽지가 않았다. 결국 나는 html이 필요하고 Quilljs의 데이터를 html로 변환해야 한다. Quilljs의 개발자는 1.0 버전에서 \u003ca href=\"https://github.com/quilljs/quill/issues/774\"\u003egetHtml을 없애버렸다\u003c/a\u003e. 이유는 더이상 에디터 dom에 class들이 붙지 않아 innerHTML 로 깨끗한 html을 얻을 수 있기 때문이라고 한다. 그런데 code-block 같은 경우는 내가 원하는 \u003ccode\u003e\u0026lt;pre\u0026gt;\u0026lt;code\u0026gt;\u003c/code\u003e가 아니라 \u003ccode\u003e\u0026lt;pre\u0026gt;\u003c/code\u003e로만 만들어진다. 거기다 syntax highlight를 하면 그 부분은 완전히 변형된다. 거의 쓸 수 없는 수준이다.\u003c/p\u003e\n\u003cp\u003e한동안 찾아다녔다. getContents를 통해서 얻은 Delta를 html로 변환하는 것을 누군가는 만들어뒀겠지 하며 찾았다. 그런데 없다. code-block를 대응한 것을 찾지 못했다. 아마도 대부분의 경우 innerHTML로 충분했던 것 같다. 아무래도 직접 만들어야 할 것 같았다. 그래서 시작했다.\u003c/p\u003e\n\u003ch2 id=\"delta-to-html\"\u003edelta-to-html\u003c/h2\u003e\n\u003cp\u003e사실 javascript로 모듈을 제작해 본 경험이 없다. 그래서 다른 모듈을 참고해서 시작했다. 테스트, 커버리지 같은 것들을 먼저 세팅했다.\u003c/p\u003e\n\u003cp\u003e테스트는 \u003ca href=\"https://mochajs.org/\"\u003emocha\u003c/a\u003e가 유명한 것 같은데 참고한 모듈이 \u003ca href=\"https://jasmine.github.io/\"\u003ejasmine\u003c/a\u003e을 사용해서 나도 jasmine을 사용해보기로 했다. ci 서비스는 이전에 \u003ca href=\"https://circleci.com/\"\u003ecircleci\u003c/a\u003e를 써봤으니 이번엔 \u003ca href=\"https://travis-ci.org/\"\u003etravis-ci\u003c/a\u003e를 사용하기로 했다. coverage는 가능하다는 것을 이번 기회에 알았다. github에 연동된 \u003ca href=\"https://coveralls.io/\"\u003ecoveralls\u003c/a\u003e라는 서비스도 있는 마당에 이런 걸 처음 알다니 ㅠㅠ 앞으로 놀지 않고 공부많이 해야겠다는 생각이 들었다.\u003c/p\u003e\n\u003cp\u003e이렇게 세팅을 하고보니 TDD가 가능할 것 같다. 결국 BDD로 하긴 했지만 어쨌든 스펙을 먼저 테스트로 만들고 해결을 해나가는 일을 정말 오랜 만에 해본 것 같다. 이것도 자꾸자꾸 해봐야 익숙해져서 또 하게 되는 것 같다.\u003c/p\u003e\n\u003ch2 id=\"-\"\u003e완성\u003c/h2\u003e\n\u003cp\u003e시행착오도 많았고, 코드가 엄청 더럽고 복잡하게 나오긴 했지만 일단은 모든 테스트를 통과하는 결과물이 나왔다. \u003ca href=\"https://www.npmjs.com/package/delta-to-html\"\u003enpm에 publish\u003c/a\u003e도 처음 해봤다. 에디터에 붙여보니 잘된다. 이제 다음 단계로 갈 차례다.\u003c/p\u003e\n            ","summary":"지금은 1월 11일 1시 11분이다. 뭐 그렇다고 ;;\nTistory Editor에 Quilljs를 붙였는데 생각했던 것처럼 쉽지가 않았다. 결국 나는 html이 필요하고 Quilljs의 데이터를 html로 변환해야 한다. Quilljs의 개발자는 1.0 버전에서 getHtml을 없애버렸다. 이유는 더이상 에디터 dom에 class들이 붙지 않아 innerHTML 로 깨끗한 html을 얻을 수 있기 때문이라고 한다. 그런데 code-block 같은 경우","image":"https://t1.daumcdn.net/tistory_admin/static/images/openGraph/opengraph.png"}},"__N_SSG":true},"page":"/tistory/[id]","query":{"id":"455"},"buildId":"k2SjylS4DhAPzPoZgQ49x","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>